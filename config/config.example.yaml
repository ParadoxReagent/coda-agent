llm:
  default_provider: "anthropic"
  default_model: "claude-sonnet-4-5-20250514"

  providers:
    anthropic:
      type: "anthropic"
      api_key: "sk-ant-..."
      models:
        - "claude-sonnet-4-5-20250514"
        - "claude-haiku-3-5-20241022"

    google:
      type: "google"
      api_key: "AIza..."
      models:
        - "gemini-2.0-flash"
        - "gemini-2.0-pro"
      capabilities:
        parallel_tool_calls: false

    openai:
      type: "openai_compat"
      base_url: "https://api.openai.com/v1"
      api_key: "sk-..."
      models:
        - "gpt-4o"
        - "gpt-4o-mini"

    openrouter:
      type: "openai_compat"
      base_url: "https://openrouter.ai/api/v1"
      api_key: "sk-or-..."
      default_headers:
        HTTP-Referer: "https://coda-agent.local"
        X-Title: "coda"
      models:
        - "anthropic/claude-sonnet-4-5"
        - "google/gemini-2.0-flash"

    ollama:
      type: "openai_compat"
      base_url: "http://localhost:11434/v1"
      api_key: "ollama"
      models:
        - "llama3.1:8b"
        - "mistral:7b"
      capabilities:
        tools: "model_dependent"
        usage_metrics: false
        json_mode: false

  cost_per_million_tokens:
    "claude-sonnet-4-5-20250514":
      input: 3.0
      output: 15.0
    "gpt-4o":
      input: 2.5
      output: 10.0
    "gemini-2.0-flash":
      input: 0.1
      output: 0.4

  daily_spend_alert_threshold: 10.0

discord:
  bot_token: ""
  channel_id: ""
  allowed_user_ids: []

redis:
  url: "redis://localhost:6379"

database:
  url: "postgresql://coda:coda@localhost:5432/coda"

server:
  port: 3000
  host: "0.0.0.0"

# Email — Gmail API with OAuth2 (preferred)
# Set up with: pnpm run setup:email-oauth
# email:
#   oauth:
#     client_id: "your-client-id.apps.googleusercontent.com"
#     client_secret: "your-client-secret"
#     redirect_port: 3000
#     scopes:
#       - "https://www.googleapis.com/auth/gmail.readonly"
#       - "https://www.googleapis.com/auth/gmail.modify"
#   gmail_user: "your-email@gmail.com"
#   labels:
#     - "INBOX"
#   poll_interval_seconds: 300
#   categorization:
#     urgent_senders: []
#     urgent_keywords: []
#     known_contacts: []

# Email — Legacy IMAP (fallback)
# email:
#   imap_host: "imap.gmail.com"
#   imap_user: "your-email@gmail.com"
#   imap_pass: "your-app-password"
#   folders:
#     - "INBOX"
#   poll_interval_seconds: 300

# Memory — semantic memory with vector embeddings
# memory:
#   base_url: "http://memory-service:8010"
#   api_key: "${MEMORY_API_KEY}"
#   context_injection:
#     enabled: true
#     max_tokens: 1500

skills:
  external_dirs: []
  external_policy:
    mode: "strict"
    trusted_signing_keys: []
    allow_unsigned_local: false
    allowed_local_unsigned_dirs:
      - "./custom-skills"

  # Agent Skills (agentskills.io standard) — instruction-based skills
  # Scan directories for subdirectories containing SKILL.md files
  agent_skill_dirs: []
  # agent_skill_dirs:
  #   - "./agent-skills"
  #   - "~/.agent-skills"

# Alerts configuration
# alerts:
#   rules:
#     "alert.email.urgent":
#       severity: "high"
#       channels: ["discord"]
#       quietHours: true
#       cooldown: 300
#     "alert.reminder.due":
#       severity: "medium"
#       channels: ["discord"]
#       quietHours: true
#       cooldown: 60
#     "alert.unifi.new_client":
#       severity: "medium"
#       channels: ["discord"]
#       quietHours: true
#       cooldown: 0
#     "alert.unifi.bandwidth_spike":
#       severity: "low"
#       channels: ["discord"]
#       quietHours: true
#       cooldown: 900
#     "alert.unifi.device_offline":
#       severity: "high"
#       channels: ["discord"]
#       quietHours: true
#       cooldown: 600
#   quiet_hours:
#     enabled: false
#     start: "22:00"
#     end: "07:00"
#     timezone: "America/New_York"
#     override_severities: ["high"]

# Sub-agent configuration
# subagents:
#   enabled: true
#   default_timeout_minutes: 5
#   max_timeout_minutes: 10
#   sync_timeout_seconds: 120
#   max_concurrent_per_user: 3
#   max_concurrent_global: 10
#   archive_ttl_minutes: 60
#   max_tool_calls_per_run: 25
#   default_token_budget: 50000
#   max_token_budget: 200000
#   spawn_rate_limit:
#     max_requests: 10
#     window_seconds: 3600
#   cleanup_interval_seconds: 60

# Firecrawl — web scraping, crawling, URL mapping, and search
# Supports both Firecrawl Cloud (api_key required) and self-hosted instances.
# Env overrides: FIRECRAWL_API_KEY, FIRECRAWL_API_URL
#
# Cloud usage (default):
# firecrawl:
#   api_key: "fc-..."                  # or set FIRECRAWL_API_KEY env var
#
# Self-hosted:
# firecrawl:
#   api_url: "http://localhost:3002"   # no api_key needed for self-hosted
#
# Full options:
# firecrawl:
#   api_key: "fc-..."
#   api_url: "https://api.firecrawl.dev"     # default; change for self-hosted
#   defaults:
#     only_main_content: true                # strip nav/footer from scrapes
#     output_format: "markdown"              # "markdown" or "html"
#     timeout_ms: 30000                      # per-request timeout
#     max_content_length: 50000              # truncate content beyond this (bytes)
#   rate_limit:
#     max_requests: 30                       # requests per window
#     window_seconds: 60                     # rate limit window
#   cache_ttl_seconds: 3600                  # cache scrape/search results (1 hour)
#
# Available tools (once enabled):
#   firecrawl_scrape        — Scrape a single URL → clean markdown
#   firecrawl_crawl         — Start async website crawl (returns job ID)
#   firecrawl_crawl_status  — Poll crawl job for progress/results
#   firecrawl_map           — Discover all URLs on a site
#   firecrawl_search        — Web search with content extraction
#
# Agent skill: activate "web-research" via skill_activate for guided
# research strategies (quick facts, docs exploration, deep research).

# Scheduler configuration (override built-in task schedules)
# scheduler:
#   tasks:
#     "health.check":
#       cron: "*/5 * * * *"
#       enabled: true
